{% extends 'appbase.html.twig' %}

{% block title %}Détails du Client
{% endblock %}

{% block stylesheets %}
	<style>
		/* Style des cartes de statistiques */
		.stat-card {
			border-radius: 10px;
			box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
			transition: transform 0.3s ease;
		}
		.stat-card:hover {
			transform: translateY(-5px);
		}
		.stat-icon {
			font-size: 1.8rem;
			margin-bottom: 10px;
		}
		.stat-number {
			font-size: 1.5rem;
			font-weight: 700;
		}
		.stat-text {
			font-size: 0.9rem;
			color: #6c757d;
		}

		/* Style pour les cartes de soldes */
		.balance-card {
			border-radius: 10px;
			box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
			transition: all 0.3s ease;
			height: 100%;
		}
		.balance-card:hover {
			transform: translateY(-5px);
			box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
		}
		.balance-flag {
			width: 40px;
			height: 30px;
			object-fit: cover;
			border-radius: 3px;
			margin-right: 10px;
		}
		.balance-currency {
			font-size: 0.9rem;
			color: #6c757d;
		}
		.balance-amount {
			font-size: 1.4rem;
			font-weight: 700;
			margin: 5px 0;
		}
		.balance-equivalent {
			font-size: 0.85rem;
			color: #6c757d;
		}
		.balance-trend {
			font-size: 0.8rem;
			padding: 3px 8px;
			border-radius: 12px;
		}


		.badge-status {
			padding: 5px 10px;
			border-radius: 20px;
			font-size: 0.8rem;
			font-weight: 600;
			text-transform: uppercase;
		}
		.badge-completed {
			background-color: #d1fae5;
			color: #065f46;
			border: 1px solid #34d399;
		}
		.badge-pending {
			background-color: #fef3c7;
			color: #92400e;
			border: 1px solid #f59e0b;
		}
		.badge-cancelled {
			background-color: #fee2e2;
			color: #991b1b;
			border: 1px solid #ef4444;
		}
		.badge-processing {
			background-color: #dbeafe;
			color: #1e40af;
			border: 1px solid #3b82f6;
		}

		/* Style de la table */
		.table-transfer {
			font-size: 0.9rem;
			border-collapse: separate;
			border-spacing: 0;
			min-height: 300px;
		}
		.table-transfer thead th {
			background-color: #f8f9fa;
			position: sticky;
			top: 0;
			border-bottom: 2px solid #dee2e6;
		}
		.table-transfer tbody tr:hover {
			background-color: rgba(0, 123, 255, 0.05);
		}
		.table-transfer .text-success {
			color: #28a745 !important;
		}
		.table-transfer .text-danger {
			color: #dc3545 !important;
		}
		.table-transfer .text-warning {
			color: #fd7e14 !important;
		}
		.currency-flag {
			display: inline-block;
			width: 40px;
			height: 30px;
			background-size: cover;
			border-radius: 3px;
			box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
		}

		.currency-flag-aed {
			background-image: url('https://flagcdn.com/w40/ae.jpg');
		}

		.currency-flag-eur {
			background-image: url('https://flagcdn.com/w40/eu.jpg');
		}

		.currency-flag-usd {
			background-image: url('https://flagcdn.com/w40/us.jpg');
		}

		.currency-flag-gbp {
			background-image: url('https://flagcdn.com/w40/gb.jpg');
		}

		.currency-flag-cny {
			background-image: url('https://flagcdn.com/w40/cn.jpg');
		}

		.modal-content {
			border: none;
			border-radius: 10px;
			box-shadow: 0 5px 25px rgba(0, 0, 0, 0.15);
		}

		.modal-header {
			border-top-left-radius: 10px;
			border-top-right-radius: 10px;
		}

		.btn {
			border-radius: 6px;
		}

		.view-btn {
			background-color: #17a2b8;
			border-color: #17a2b8;
		}

		.view-btn:hover {
			background-color: #138496;
			border-color: #117a8b;
		}

		.card {
			border: none;
			border-radius: 8px;
			box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
		}

		.card-header {
			border-radius: 8px 8px 0 0 !important;
		}

		.alert {
			border-radius: 8px;
			border: none;
		}
	</style>
{% endblock %}

{% block main %}
	<div
		class="container-fluid">

		{# --- 1. Informations du Client --- #}
		<div class="card card-info card-outline mb-4">
			<div class="card-header">
				<h3 class="card-title">Informations du Client</h3>
			</div>
			<div class="card-body">
				<form>
					<div class="row mb-2">
						<div class="col-md-5">
							<label class="form-label">
								<strong>Nom complet :</strong>
							</label>
							<input type="text" class="form-control" value="{{ client.nomComplet }}" disabled>
						</div>
						<div class="col-md-3">
							<label class="form-label">
								<strong>Téléphone :</strong>
							</label>
							<input type="text" class="form-control" value="{{ client.phoneNumber }}" disabled>
						</div>
					</div>
					<div class="row mb-2">
						<div class="col-md-6">
							<label class="form-label">
								<strong>Adresse :</strong>
							</label>
							<input type="text" class="form-control" value="{{ client.address }}" disabled>
						</div>
						<div class="col-md-3">
							<label class="form-label">
								<strong>Date d'inscription :</strong>
							</label>
							<input type="text" class="form-control" value="--" disabled>
						</div>
					</div>
				</form>
			</div>
		</div>

		{# --- 2. Soldes du Client --- #}
		<div class="card card-primary card-outline mb-4">
			<div class="card-header d-flex justify-content-between align-items-center bg-opacity-25">
				<h3 class="card-title">Soldes du Client | Echanges</h3>
				<button class="btn btn-sm btn-outline-primary exchange" id="btnExchange" data-id="{{client.id}}" title="Echanger">
					<i class="bi bi-currency-exchange"></i>Echanger
				</button>
			</div>
			<div class="card-body">
				<div
					class="row" id="clientBalances">
					<!-- Les soldes seront chargés dynamiquement ici -->
					<div class="col-12 text-center py-4">
						<div class="spinner-border text-primary" role="status">
							<span class="visually-hidden">Chargement des soldes...</span>
						</div>
						<p class="mt-2">Chargement des soldes...</p>
					</div>
				</div>

				<div class="table-responsive">
					<table id="exchangesTable" class="table table-bordered table-hover table-striped border-top border-bottom">
						<thead>
							<tr>
								<th width="200">Date</th>
								<th>Montant d'origine</th>
								<th>Taux</th>
								<th>Montant Echangée</th>
								<th>Actions</th>
							</tr>
						</thead>
						<tbody></tbody>
					</table>
				</div>
			</div>
		</div>


		{# --- 3. Transferts --- #}
		<div class="card card-success card-outline mt-4">
			<div class="card-header d-flex justify-content-between align-items-center bg-opacity-25">
				<h3 class="card-title">Transferts</h3>
				<button id="btnAddTransfert" class="btn btn-sm btn-primary">
					<i class="bi bi-plus-lg"></i>
					Transferer
				</button>
			</div>
			<div
				class="card-body">
				{# --- Stats --- #}
				<div
					class="row mb-4" id="transferStats">

					<!-- Total Transferts -->
					<div class="col-md-3 mb-3">
						<div class="card stat-card border-start border-primary border-4">
							<div class="card-body">
								<div class="d-flex justify-content-between align-items-center">
									<div>
										<div class="stat-text">Total Transferts</div>
										<div class="stat-number text-primary" id="stat-total">0</div>
									</div>
									<div class="stat-icon text-primary">
										<i class="bi bi-arrow-left-right"></i>
									</div>
								</div>
								<hr class="my-2">
								<div class="d-flex justify-content-between">
									<small class="text-success">
										<i class="bi bi-check-circle"></i>
										<span id="stat-valide">0</span>
									</small>
									<small class="text-warning">
										<i class="bi bi-hourglass"></i>
										<span id="stat-attente">0</span>
									</small>
									<small class="text-danger">
										<i class="bi bi-x-circle"></i>
										<span id="stat-annule">0</span>
									</small>
								</div>
							</div>
						</div>
					</div>

					<!-- Montants globaux -->
					<div class="col-md-3 mb-3">
						<div class="card stat-card border-start border-warning border-4">
							<div class="card-body">
								<div class="d-flex justify-content-between align-items-center">
									<div>
										<div class="stat-text">Montant Total Envoyé</div>
										<div class="stat-number text-warning" id="stat-montant">0 FCFA</div>
									</div>
									<div class="stat-icon text-warning">
										<i class="bi bi-cash-stack"></i>
									</div>
								</div>
								<hr class="my-2">
								<div class="d-flex justify-content-between">
									<small class="text-danger">Frais:
										<span id="stat-frais">0</span>
									</small>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="row mb-3">
					<div class="col-md-4">
						<input type="text" id="filterDateRange" class="form-control" placeholder="Période (ex. 01/01/2025 - 31/01/2025)">
					</div>
					<div class="col-md-4">
						<select id="filterStatus" class="form-select">
							<option value="">Tous</option>
							<option value="pending">En cours</option>
							<option value="completed">Confirmé</option>
							<option value="cancelled">Annulé</option>
						</select>
					</div>
					<div class="col-md-4">
						<select id="filterType" class="form-select form-control">
							<option value="">Tous types</option>
							<option value="standard">Envoi Cash</option>
							<option value="byAccount">Retrait compte</option>
						</select>
					</div>
				</div>
				<table id="transfersTable" class="table table-bordered table-hover table-striped border-top border-bottom">
					<thead>
						<tr>
							<th width="100">Type</th>
							<th>Destinataire</th>
							<th width="150">Montant</th>
							<th width="120">Taux</th>
							<th width="120">Frais</th>
							<th width="150">Total remis</th>
							<th width="160">Statut</th>
							<th width="100">Actions</th>
						</tr>
					</thead>
					<tbody></tbody>
				</table>
			</div>
		</div>

		{# --- 4. Transactions du Client --- #}
		<div class="card card-primary card-outline mt-4">
			<div class="card-header d-flex justify-content-between align-items-center bg-primary bg-opacity-25">
				<h3 class="card-title mb-0">Toutes les transactions</h3>
				<div class="d-flex align-items-center">
					<label for="filterTransactionType" class="me-2 mb-0 w-50">Type :</label>
					<select id="filterTransactionType" class="form-select form-select-sm " style="min-width:120px;">
						<option value="">Tous</option>
						<option value="Entrée">Entrée</option>
						<option value="Sortie">Sortie</option>
					</select>
				</div>

			</div>
			<div class="card-body">
				<table id="transactionsTable" class="table table-bordered table-hover table-striped border-top border-bottom">
					<thead>
						<tr>
							<th width="200">Date</th>
							<th width="100">Type</th>
							<th width="200">Montant</th>
							<th width="100">Devise</th>
							<th>Descritpion</th>
						</tr>
					</thead>
					<tbody></tbody>
				</table>
			</div>
		</div>

		<button class="btn btn-lg btn-success" id="btnAccompte" data-id="{{client.id}}" style="position: fixed; bottom: 260px; right: 20px; z-index: 1000;" title="Accompte">
			<i class="bi bi-wallet2"></i>
		</button>

		<button class="btn btn-lg btn-warning" id="btnWithdraw" data-id="{{client.id}}" style="position: fixed; bottom: 200px; right: 20px; z-index: 1000;" title="Retrait">
			<i class="bi bi-paypal"></i>
		</button>


		<button class="btn btn-lg btn-info exchange" id="btnExchangeFloat" data-id="{{client.id}}" style="position: fixed; bottom: 140px; right: 20px; z-index: 1000;" title="Echanger">
			<i class="bi bi-currency-exchange"></i>
		</button>
		{# Floating Back Button #}
		<button id="btnBack" class="btn btn-secondary btn-lg shadow back-button" onclick="history.back();" style="position: fixed; bottom: 20px; right: 20px; z-index: 1000;">
			<i class="bi bi-arrow-left"></i>
		</button>

		<button id="btnAddTransfertFloat" class="btn btn-lg btn-primary" style="position: fixed; bottom: 80px; right: 20px; z-index: 1000;">
			<i class="bi bi-plus-lg"></i>
		</button>
	</div>


	{# 3a. Modal Ajout Facture Ponctuelle #}
	<div class="modal fade" id="modalAddTransfert" tabindex="-1" aria-hidden="true">
		<div class="modal-dialog modal-lg">
			<div class="modal-content p-4">
				<form
					id="form-add-transfer">
					<!-- Section Opération -->
					<div class="section mb-4 p-3 border rounded">
						<h4 class="text-primary mb-3">
							<i class="bi bi-gear-fill me-2"></i>Opération
						</h4>
						<div class="row g-3">
							<div class="col-md-4">
								<label class="form-label fw-bold">Date
									<span class="text-danger">*</span>
								</label>
								<input type="date" id="dateOps" name="date" class="form-control shadow-sm" required>
							</div>
							<div class="col-md-4">
								<label class="form-label fw-bold">Type
									<span class="text-danger">*</span>
								</label>
								<select id="typeOps" name="type" class="form-select shadow-sm" required>
									<option value="standard">Envoi Cash</option>
									<option value="byAccount">Retrait sur compte</option>
								</select>
							</div>
							<div class="col-md-4">
								<label class="form-label fw-bold">Destination
									<span class="text-danger">*</span>
								</label>
								<select id="destination" name="destination" class="form-select shadow-sm country-select" required>
									<option value="EAU">🇦🇪
										<strong>Dubaï</strong>
										- Emirates-Arabes-Unis</option>
									<option value="FR">🇫🇷
										<strong>Paris</strong>
										- France</option>
									<option value="USA">🇺🇸
										<strong>Washington D.C.</strong>
										- États-Unis</option>
									<option value="UK">🇬🇧
										<strong>Londres</strong>
										- Royaume-Uni</option>
									<option value="CHI">🇨🇳
										<strong>Pékin</strong>
										- Chine</option>
									<option value="MRC">🇲🇦
										<strong>Rabat</strong>
										- Maroc</option>
									<option value="ALG">🇩🇿
										<strong>Alger</strong>
										- Algérie</option>
								</select>
							</div>
						</div>
					</div>
					<!-- Section Expéditeur -->
					<div class="section mb-4">
						<div
							class="row g-3">
							<!-- Section Expéditeur -->
							<div class="col-lg-6 col-md-12 mb-3 mb-lg-0">
								<div class="p-3 border rounded h-100">
									<h4 class="text-primary mb-3">
										<i class="bi bi-person-fill me-2"></i>Expéditeur
									</h4>
									<div class="row g-2">
										<div class="col-12">
											<label class="form-label fw-bold" style="font-size:  20px;">
												{{ client.nomComplet }}
												<span class="text-danger"></span>
											</label>

										</div>
										<div id="expediteur-phone" class="col-12 mt-2">
											<div class="p-2 bg-light rounded">
												<small class="text-muted">Téléphone :</small>
												<div class="fw-bold">{{ client.phoneNumber }}</div>
											</div>
										</div>

									</div>
								</div>
							</div>
							<!-- Section Bénéficiaire -->
							<div class="col-lg-6 col-md-12">
								<div class="p-3 border rounded h-100">
									<h4 class="text-primary mb-3">
										<i class="bi bi-person-check-fill me-2"></i>Bénéficiaire
									</h4>
									<div class="row g-2">
										<div class="col-12">
											<label class="form-label fw-bold">Nom complet</label>
											<input type="text" id="nomBeneficiaire" name="nomBeneficiaire" class="form-control shadow-sm" placeholder="Nom du bénéficiaire">
										</div>
										<div class="col-12">
											<label class="form-label fw-bold">Téléphone
												<span class="text-danger">*</span>
											</label>
											<div class="input-group">
												<span class="input-group-text">
													<i class="bi bi-phone"></i>
												</span>
												<input type="text" id="phoneBeneficiaire" name="phoneBeneficiaire" class="form-control shadow-sm" placeholder="+1234567890">
											</div>
										</div>

									</div>
								</div>
							</div>
						</div>
					</div>
					<!-- Section Montants -->
					<div class="section mb-4 p-3 border rounded">
						<h4 class="text-primary mb-3">
							<i class="bi bi-cash-stack me-2"></i>Montants et Frais
						</h4>
						<div
							class="row g-3">
							<!-- Montant Cash -->
							<div class="col-md-4">
								<label class="form-label fw-bold">Montant Cash
									<span class="text-danger">*</span>
								</label>
								<div class="input-group shadow-sm">
									<span class="input-group-text bg-light">CFA</span>
									<input type="number" id="montantCash" name="montantCash" class="form-control" placeholder="0.00" step="0.01" required>
								</div>
							</div>
							<!-- Frais d'envoi -->
							<div class="col-md-4">
								<label class="form-label fw-bold">Frais d'envoi
									<span class="text-danger">*</span>
								</label>
								<div class="input-group shadow-sm">
									<input type="number" id="fraisEnvoi" name="fraisEnvoi" class="form-control shadow-sm" placeholder="0.00" step="0.01">
									<span class="input-group-text bg-light">CFA</span>
								</div>
							</div>
							<!-- Taux de change -->
							<div class="col-md-4">
								<label class="form-label fw-bold">Taux
									<span class="text-danger">*</span>
								</label>
								<div class="input-group shadow-sm">
									<span class="input-group-text">1</span>
									<span class="input-group-text bg-light">USD</span>
									<span class="input-group-text">=</span>
									<input type="number" id="taux" name="taux" class="form-control" placeholder="0.00" step="0.0001" value="562.58" required>
									<span class="input-group-text bg-light">CFA</span>
								</div>
							</div>
							<!-- Montant Reçu (calculé automatiquement) -->
							<div class="col-md-4">
								<label class="form-label fw-bold">Montant Reçu</label>
								<div class="input-group shadow-sm">
									<span class="input-group-text bg-light">USD</span>
									<input type="number" id="montantRecu" name="montantRecu" class="form-control" placeholder="0.00" step="0.01" readonly>
								</div>
							</div>


							<div class="col-md-8">
								<label class="form-label fw-bold" id="nomDeviseReceptionTaux">Taux de devise reception
									<span class="text-danger">*</span>
								</label>
								<div class="input-group shadow-sm">
									<span class="input-group-text">1</span>
									<span id="deviseOrigineDisplay" class="input-group-text bg-light">USD</span>
									<span class="input-group-text">=</span>
									<input type="number" id="tauxReception" name="tauxReception" class="form-control" placeholder="0.00" step="0.0001" value="3.67" required>
									<span class="input-group-text bg-light" id="deviseRecueDisplay">AED</span>
									<input type="number" id="montantDeviseReception" name="montantDevise" class="form-control bg-info" placeholder="0.00" step="0.01" readonly>
								</div>
							</div>

							<!-- Total à payer -->
							<div class="col-md-12">
								<div class="p-3 bg-light rounded">
									<div class="d-flex justify-content-between total-display">
										<span class="fw-bold">Total à payer:</span>
										<span id="totalAPayer" class="fw-bold text-success display-6">0.00 CFA</span>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="d-flex justify-content-between mt-4">
						<button type="reset" id="resetForm" class="btn btn-outline-secondary">
							<i class="bi bi-arrow-counterclockwise me-2"></i>Réinitialiser
						</button>
						<button id="cancelAddTransfert" class="btn btn-outline-danger" data-bs-dismiss="modal">
							<i class="bi bi-arrow-left me-2"></i>Annuler
						</button>
						<button type="submit" class="btn btn-primary px-4">
							<i class="bi bi-save-fill me-2"></i>Créer le transfert
						</button>
					</div>
				</form>
			</div>
		</div>
	</div>

	<!-- Modal View Transfer -->
	<div class="modal fade" id="viewTransferModal" tabindex="-1" aria-hidden="true">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				<div class="modal-header bg-light">
					<h5 class="modal-title">Détails du Transfert
						<span id="transferReference" class="badge bg-primary ms-2"></span>
					</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body">
					<div
						class="row">
						<!-- Section Informations Générales -->
						<div class="col-md-6">
							<div class="card mb-3">
								<div class="card-header bg-light">
									<h6 class="mb-0">
										<i class="bi bi-info-circle me-2"></i>Informations Générales</h6>
								</div>
								<div class="card-body">
									<div class="mb-2">
										<small class="text-muted">Date de création:</small>
										<div class="fw-bold" id="transferDate"></div>
									</div>
									<div class="mb-2">
										<small class="text-muted">Type:</small>
										<div class="fw-bold" id="transferType"></div>
									</div>
									<div class="mb-2">
										<small class="text-muted">Destination:</small>
										<div class="fw-bold" id="transferDestination"></div>
									</div>
									<div class="mb-2">
										<small class="text-muted">Statut:</small>
										<div id="transferStatus"></div>
									</div>
								</div>
							</div>

							<!-- Section Expéditeur -->
							<div class="card mb-3">
								<div class="card-header bg-light">
									<h6 class="mb-0">
										<i class="bi bi-person-fill me-2"></i>Expéditeur</h6>
								</div>
								<div class="card-body">
									<div class="mb-2">
										<small class="text-muted">Nom complet:</small>
										<div class="fw-bold" id="senderName"></div>
									</div>
									<div class="mb-2">
										<small class="text-muted">Téléphone:</small>
										<div class="fw-bold" id="senderPhone"></div>
									</div>
									<div class="mb-2">
										<small class="text-muted">Type client:</small>
										<div class="fw-bold" id="senderType"></div>
									</div>
								</div>
							</div>
						</div>

						<!-- Section Bénéficiaire et Montants -->
						<div
							class="col-md-6">
							<!-- Section Bénéficiaire -->
							<div class="card mb-3">
								<div class="card-header bg-light">
									<h6 class="mb-0">
										<i class="bi bi-person-check-fill me-2"></i>Bénéficiaire</h6>
								</div>
								<div class="card-body">
									<div class="mb-2">
										<small class="text-muted">Nom complet:</small>
										<div class="fw-bold" id="beneficiaryName"></div>
									</div>
									<div class="mb-2">
										<small class="text-muted">Téléphone:</small>
										<div class="fw-bold" id="beneficiaryPhone"></div>
									</div>

								</div>
							</div>

							<!-- Section Montants -->
							<div class="card mb-3">
								<div class="card-header bg-light">
									<h6 class="mb-0">
										<i class="bi bi-cash-stack me-2"></i>Montants</h6>
								</div>
								<div class="card-body">
									<div class="mb-2">
										<small class="text-muted">Montant envoyé:</small>
										<div class="fw-bold text-success" id="transferAmount"></div>
									</div>
									<div class="mb-2">
										<small class="text-muted">Frais d'envoi:</small>
										<div class="fw-bold text-danger" id="transferFees"></div>
									</div>
									<div class="mb-2">
										<small class="text-muted">Taux de change USD:</small>
										<div class="fw-bold" id="transferRate"></div>
									</div>
									<div class="mb-2">
										<small class="text-muted">Montant envoyé USD:</small>
										<div class="fw-bold text-success" id="transferAmountUSD"></div>
									</div>
									<div class="mb-2">
										<small class="text-muted">Taux de change
											<span id="deviseDestination"></span>:</small>
										<div class="fw-bold" id="destinationRate"></div>
									</div>
									<div class="mb-2">
										<small class="text-muted">Montant reception:</small>
										<div class="fw-bold text-success" id="destinationAmount"></div>
									</div>
									<hr>
									<div class="d-flex justify-content-between">
										<small class="text-muted">Total payer:</small>
										<div class="fw-bold fs-5 text-success" id="transferTotal"></div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="modal-footer bg-light">
					<div class="d-flex justify-content-between w-100">
						<div>
							<button id="printReceiptBtn" class="btn btn-outline-secondary me-2">
								<i class="bi bi-printer me-1"></i>
								Imprimer
							</button>
							<button id="downloadReceiptBtn" class="btn btn-outline-secondary">
								<i class="bi bi-download me-1"></i>
								Télécharger
							</button>
						</div>
						<div>
							<button type="button" class="btn btn-secondary me-2" data-bs-dismiss="modal">
								<i class="bi bi-x-circle me-1"></i>
								Fermer
							</button>
							<div class="btn-group">
								<button id="validateTransferBtn" class="btn btn-success d-none">
									<i class="bi bi-check-circle me-1"></i>
									Valider
								</button>
								<button id="cancelTransferBtn" class="btn btn-danger d-none">
									<i class="bi bi-x-circle me-1"></i>
									Annuler
								</button>
								<button id="deleteTransferBtn" class="btn btn-outline-danger d-none">
									<i class="bi bi-trash me-1"></i>
									Supprimer
								</button>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- Modal Échange de Devise -->
	<div class="modal fade" id="currencyModal" tabindex="-1" aria-labelledby="currencyModalLabel" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="currencyModalLabel">Échange de Devise</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body">
					<input type="hidden" name="clientId" id="exchangeClientId">
					<div class="row">
						<div class="col-md-6">

							<div class="mb-3">
								<label for="fromCurrency" class="form-label">Devise de départ:</label>
								<select class="form-select" id="fromCurrency" name="fromCurrency">
									<option value="CFA">CFA - BECEAO</option>
									<option value="AED">AED - Dirham des Émirats Arabes Unis</option>
									<option value="EUR">EUR - Euro</option>
									<option value="USD">USD - Dollar américain</option>
									<option value="GBP">GBP - Livre sterling</option>
									<option value="CNY">CNY - Yuan chinois</option>
									<option value="MAD">MAD - Dirham marocain</option>
									<option value="DZD">DZD - Dinar algérien</option>
								</select>

							</div>
							<div class="mb-3">
								<label for="fromAmount" class="form-label">Montant:</label>
								<input type="number" class="form-control" id="fromAmount" name="fromAmount" placeholder="Montant">
							</div>
							<div class="mb-3">
								<label for="exchangeRate" class="form-label">Taux:</label>
								<input type="number" class="form-control" id="exchangeRate" name="exchangeRate" placeholder="Taux">
							</div>
						</div>
						<div class="col-md-6">
							<div class="mb-3">
								<label for="toCurrency" class="form-label">Devise d'arrivée:</label>
								<select class="form-select" id="toCurrency" name="toCurrency">
									<option value="CFA">CFA - BECEAO</option>
									<option value="AED">AED - Dirham des Émirats Arabes Unis</option>
									<option value="EUR">EUR - Euro</option>
									<option value="USD">USD - Dollar américain</option>
									<option value="GBP">GBP - Livre sterling</option>
									<option value="CNY">CNY - Yuan chinois</option>
									<option value="MAD">MAD - Dirham marocain</option>
									<option value="DZD">DZD - Dinar algérien</option>
								</select>
							</div>
							<div class="mb-3">
								<label for="toAmount" class="form-label">Montant:</label>
								<input type="number" class="form-control" id="toAmount" name="toAmount" placeholder="Montant" readonly>
							</div>
						</div>
					</div>
					<div class="mb-3">
						<label class="form-label">Solde actuel:</label>
						<span id="currentBalance"></span>
					</div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fermer</button>
					<button type="button" class="btn btn-primary" id="exchangeButton">Échanger</button>
				</div>
			</div>
		</div>
	</div>

	<!-- Modal de confirmation pour la validation -->
	<div class="modal fade" id="confirmValidateModal" tabindex="-1" role="dialog" aria-labelledby="confirmValidateModalLabel" aria-hidden="true">
		<div class="modal-dialog" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="confirmValidateModalLabel">Confirmer la validation</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body">
					Êtes-vous sûr de vouloir valider ce transfert ?
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
					<button type="button" class="btn btn-primary" id="confirmValidate">Valider</button>
				</div>
			</div>
		</div>
	</div>

	<!-- Modal de confirmation pour l'annulation -->
	<div class="modal fade" id="confirmCancelModal" tabindex="-1" role="dialog" aria-labelledby="confirmCancelModalLabel" aria-hidden="true">
		<div class="modal-dialog" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="confirmCancelModalLabel">Confirmer l'annulation</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body">
					Êtes-vous sûr de vouloir annuler ce transfert ?
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
					<button type="button" class="btn btn-primary" id="confirmCancel">Annuler le transfert</button>
				</div>
			</div>
		</div>
	</div>

	<!-- Modal de confirmation pour la suppression -->
	<div class="modal fade" id="confirmDeleteModal" tabindex="-1" role="dialog" aria-labelledby="confirmDeleteModalLabel" aria-hidden="true">
		<div class="modal-dialog" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="confirmDeleteModalLabel">Confirmer la suppression</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body">
					Êtes-vous sûr de vouloir supprimer définitivement ce transfert ?
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
					<button type="button" class="btn btn-danger" id="confirmDelete">Supprimer</button>
				</div>
			</div>
		</div>
	</div>

	<!-- Modal de détails -->
	<div class="modal fade" id="exchangeDetailModal" tabindex="-1" aria-labelledby="exchangeDetailModalLabel" aria-hidden="true">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				<div class="modal-header bg-primary text-white">
					<h5 class="modal-title" id="exchangeDetailModalLabel">Détails de l'Échange</h5>
					<button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body">
					<div class="row">
						<div class="col-md-6">
							<div class="card mb-3">
								<div class="card-header bg-light">
									<h6 class="card-title mb-0">Devise Source</h6>
								</div>
								<div class="card-body">
									<div
										class="d-flex align-items-center">
										{# <div class="flex-shrink-0">
										                                        <span class="currency-flag currency-flag-aed" style="width: 40px; height: 30px; display: inline-block; background-size: cover;"></span>
										                                    </div> #}
										<div class="flex-grow-1 ms-3">
											<h4 id="detail-from-amount" class="mb-0">0.00</h4>
											<span id="detail-from-currency" class="text-muted">USD</span>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="col-md-6">
							<div class="card mb-3">
								<div class="card-header bg-light">
									<h6 class="card-title mb-0">Devise Cible</h6>
								</div>
								<div class="card-body">
									<div
										class="d-flex align-items-center">
										{# <div class="flex-shrink-0">
										                                        <span class="currency-flag currency-flag-eur" style="width: 40px; height: 30px; display: inline-block; background-size: cover;"></span>
										                                    </div> #}
										<div class="flex-grow-1 ms-3">
											<h4 id="detail-to-amount" class="mb-0">0.00</h4>
											<span id="detail-to-currency" class="text-muted">EUR</span>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>

					<div class="row">
						<div class="col-md-12">
							<div class="card">
								<div class="card-header bg-light">
									<h6 class="card-title mb-0">Informations sur la Transaction</h6>
								</div>
								<div class="card-body">
									<div class="row">
										<div class="col-md-6 mb-2">
											<strong>Date et Heure:</strong>
											<span id="detail-date">26/08/2025 14:47:38</span>
										</div>
										<div class="col-md-6 mb-2">
											<strong>Taux appliqué:</strong>
											<span id="detail-taux">3.78000</span>
										</div>
										<div class="col-md-6 mb-2">
											<strong>Référence:</strong>
											<span id="detail-reference">EX-002345</span>
										</div>
										<div class="col-md-6 mb-2">
											<strong>Statut:</strong>
											<span class="badge bg-success" id="detail-status">Complété</span>
										</div>
										<div class="col-md-12 mb-2">
											<strong>Notes:</strong>
											<p id="detail-notes" class="text-muted">Aucune note</p>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fermer</button>
					<button type="button" class="btn btn-primary" id="detail-print-btn">
						<i class="bi bi-printer me-1"></i>
						Imprimer
					</button>
				</div>
			</div>
		</div>
	</div>

	<!-- Modal de confirmation de suppression -->
	<div class="modal fade" id="deleteConfirmModal" tabindex="-1" aria-labelledby="deleteConfirmModalLabel" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header bg-danger text-white">
					<h5 class="modal-title" id="deleteConfirmModalLabel">Confirmer la Suppression</h5>
					<button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body">
					<div class="text-center mb-4">
						<i class="bi bi-exclamation-triangle-fill text-danger" style="font-size: 3rem;"></i>
					</div>
					<p class="text-center">Êtes-vous sûr de vouloir supprimer cet échange ?</p>
					<div class="alert alert-warning" role="alert">
						<i class="bi bi-info-circle me-2"></i>
						Cette action est irréversible. Toutes les données associées à cet échange seront définitivement perdues.
					</div>
					<div class="card mt-3">
						<div class="card-body">
							<h6 class="card-title">Détails de l'échange</h6>
							<p class="mb-1">
								<strong>Référence:</strong>
								<span id="delete-reference">EX-002345</span>
							</p>
							<p class="mb-1">
								<strong>Date:</strong>
								<span id="delete-date">26/08/2025</span>
							</p>
							<p class="mb-0">
								<strong>Montant:</strong>
								<span id="delete-amount">200.00 AED</span>
							</p>
						</div>
					</div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
					<button type="button" class="btn btn-danger" id="confirm-delete-btn">
						<i class="bi bi-trash me-1"></i>
						Supprimer définitivement
					</button>
				</div>
			</div>
		</div>
	</div>

	<!-- Modal Retrait Client -->
	<div class="modal fade" id="modalWithdrawClient" tabindex="-1" aria-labelledby="modalWithdrawClientLabel" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<form id="form-withdraw-client">
					<div class="modal-header">
						<h5 class="modal-title" id="modalWithdrawClientLabel">Effectuer un retrait</h5>
						<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
					</div>
					<div class="modal-body">
						<input type="hidden" name="clientId" id="withdrawClientId">
						<div class="mb-3">
							<label class="form-label fw-bold">Devise
								<span class="text-danger">*</span>
							</label>
							<select id="deviseW" name="deviseW" class="form-select shadow-sm country-select" required>
								<option value="CFA">CFA - BECEAO</option>
								<option value="AED">AED - Dirham des Émirats Arabes Unis</option>
								<option value="EUR">EUR - Euro</option>
								<option value="USD">USD - Dollar américain</option>
								<option value="GBP">GBP - Livre sterling</option>
								<option value="CNY">CNY - Yuan chinois</option>
								<option value="MAD">MAD - Dirham marocain</option>
								<option value="DZD">DZD - Dinar algérien</option>
							</select>
							<small>Solde :
								<span id='soldeDeviseW' class='texteprimary'></span>
							</small>
						</div>
						<div class="mb-3">
							<label for="withdrawAmount" class="form-label">Montant du retrait</label>
							<input type="number" class="form-control" id="withdrawAmount" name="amount" min="1" required>
						</div>

						<div class="mb-3">
							<label for="withdrawNote" class="form-label">Note (optionnel)</label>
							<textarea class="form-control" id="withdrawNote" name="note" rows="2"></textarea>
						</div>
						<div class="mb-3">
							<label for="withdrawDate" class="form-label">Date du retrait</label>
							<input type="date" class="form-control" id="withdrawDate" name="date" required>
						</div>
						<div class="mb-3">
							<label for="withdrawMode" class="form-label">Mode de paiement</label>
							<select class="form-select" id="withdrawMode" name="mode" required>
								<option value="Espèces">Espèces</option>
								<option value="Chèque">Chèque</option>
								<option value="Virement">Virement</option>
							</select>
						</div>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
						<button type="submit" class="btn btn-success">Enregistrer le retrait</button>
					</div>
				</div>
			</form>
		</div>
	</div>
</div>


<!-- Modal Versement Client -->
<div class="modal fade" id="modalAccompteClient" tabindex="-1" aria-labelledby="modalAccompteClientLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<form id="form-accompte-client">
				<div class="modal-header">
					<h5 class="modal-title" id="modalAccompteClientLabel">Effectuer un versement</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
				</div>
				<div class="modal-body">
					<input type="hidden" name="clientId" id="accompteClientId">
					<div class="mb-3">
						<label class="form-label fw-bold">Devise
							<span class="text-danger">*</span>
						</label>
						<select id="deviseA" name="deviseA" class="form-select shadow-sm country-select" required>
							<option value="CFA">CFA - BECEAO</option>
							<option value="AED">AED - Dirham des Émirats Arabes Unis</option>
							<option value="EUR">EUR - Euro</option>
							<option value="USD">USD - Dollar américain</option>
							<option value="GBP">GBP - Livre sterling</option>
							<option value="CNY">CNY - Yuan chinois</option>
							<option value="MAD">MAD - Dirham marocain</option>
							<option value="DZD">DZD - Dinar algérien</option>
						</select>
						<small>Solde :
							<span id='soldeDeviseA' class='texteprimary'></span>
						</small>
					</div>
					<div class="mb-3">
						<label for="accompteAmount" class="form-label">Montant du versement</label>
						<input type="number" class="form-control" id="accompteAmount" name="amount" min="1" required>
					</div>
					<div class="mb-3">
						<label for="accompteNote" class="form-label">Note (optionnel)</label>
						<textarea class="form-control" id="accompteNote" name="note" rows="2"></textarea>
					</div>
					<div class="mb-3">
						<label for="accompteDate" class="form-label">Date du versement</label>
						<input type="date" class="form-control" id="accompteDate" name="date" required>
					</div>
					<div class="mb-3">
						<label for="accompteMode" class="form-label">Mode de paiement</label>
						<select class="form-select" id="accompteMode" name="mode" required>
							<option value="Espèces">Espèces</option>
							<option value="Chèque">Chèque</option>
							<option value="Virement">Virement</option>
						</select>
					</div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
					<button type="submit" class="btn btn-success">Enregistrer le versement</button>
				</div>
			</form>
		</div>
	</div>
</div>{% endblock %}{% block javascripts %}
<script src="{{ asset('assets/appjs/client_show.js') }}"></script>{% endblock %}
